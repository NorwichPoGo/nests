{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/utils.js","webpack:///./src/js/settings.js","webpack:///./src/js/map.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","urlParameter","parameterName","parameters","decodeURIComponent","window","location","search","substring","split","parameterValue","$","each","index","param","paramParts","paramName","paramValue","undefined","isMobile","test","navigator","userAgent","coordinateToLatLng","coord","google","maps","LatLng","dateToString","date","pad","getFullYear","getMonth","getDate","Utils","Settings","settingName","setting","settings","rawSettingValue","localStorage","getItem","getURLValue","urlValue","defaultValue","type","parseFloat","JSON","parse","setItem","stringify","showGyms","showPokestops","showPortals","showParks","highlightNewFeatures","s2Cells","s2CellColors","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","mapCenter","lat","lng","zoomLevel","fetchFeatureData","chunkSize","start","request","ajax","url","dataType","Promise","resolve","loadFeatures","featureData","baseURL","protocol","host","pathname","dateOfLastUpdate","Date","feature","dateAdded","validFeatures","latitude","longitude","toLowerCase","coords","permalinkName","id","permalink","getTime","isNew","hide","marker","setMap","show","map","shouldRedraw","this","shouldShow","draw","isShown","redraw","drawFeature","push","featureMarkerIcons","gym","new_gym","pokestop","new_pokestop","portal","new_portal","markerIcon","anchorX","featureMarker","Marker","position","icon","scaledSize","Size","anchor","Point","zIndex","featureLabel","description","content","replace","InfoWindow","pixelOffset","gymLabel","pokestopLabel","portalLabel","label","isOpen","_open","open","_close","close","setPosition","addListener","addLabelActions","initMap","Map","document","getElementById","center","zoom","gestureHandling","fullscreenControl","streetViewControl","mapTypeControl","clickableIcons","mapTypeControlOptions","style","MapTypeControlStyle","HORIZONTAL_BAR","ControlPosition","LEFT_BOTTOM","mapTypeIds","MapTypeId","ROADMAP","SATELLITE","HYBRID","searchBoxInput","createElement","setAttribute","searchBoxDropdown","controls","TOP_LEFT","searchBox","prop","dropdown","appendTo","click","e","stopPropagation","add","resultWrapper","resultIcon","resultMatch","innerHTML","resultDescription","appendChild","panTo","on","empty","features","nameLookup","matches","currentTarget","visibleMatches","filter","match","slice","initSearchBox","drawS2Cells","newS2Cells","oldS2Cells","s2Cell","merge","updateS2Cells","cancelS2CellUpdate","pendingS2CellUpdate","setTimeout","getBounds","mapBounds","swBound","getSouthWest","neBound","getNorthEast","southWest","S2","S2LatLng","fromDegrees","northEast","screenRegion","S2LatLngRect","fromLatLng","level","shouldDisplayCellLevel","regionCoverer","S2RegionCoverer","setMinLevel","setMaxLevel","setMaxCells","s2CellIds","getCoveringCells","s2CellId","S2Cell","polygon","inArray","s2PointToGMapsLatLng","s2Point","s2LatLng","fromPoint","latDegrees","toNumber","lngDegrees","verticies","getVertex","color","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","drawS2Cell","loadS2Cells","clearTimeout","cellLevelLimit","getZoom","event","initS2Cells","showFeatures","fetchFeatureCount","then","featureCount","chunks","Math","ceil","featureDataPromises","promise","all","featureDataChunks","reduce","chunk","concat","loadAndDrawFeatureDataIncrementally","Fuse","shouldSort","threshold","distance","maxPatternLength","minMatchCharLength","keys","initFeatures","getJSON","parks","parksLayer","Data","addGeoJson","setStyle","initParks","setS2CellLevelOptions","s2CellLevelOptions","optionTag","html","selectpicker","collapse","bootstrapSwitch","state","set","getCenter","size","dropupAuto","val","initSettings"],"mappings":"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","file":"map.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","'use strict';\n\n/**\n * Modified from https://stackoverflow.com/questions/19491336 .\n */\nconst urlParameter = parameterName => {\n  const parameterString = decodeURIComponent(window.location.search.substring(1));\n  const parameters = parameterString.split('&');\n\n  let parameterValue;\n  $.each(parameters, function (index, param) {\n    const paramParts = param.split('=');\n    const paramName = paramParts[0];\n    const paramValue = paramParts[1];\n\n    if ((paramName == parameterName)\n        && (paramValue !== undefined)) {\n      parameterValue = paramValue;\n      return false;\n    }\n  });\n\n  return parameterValue;\n};\n\nconst isMobile = () => {\n  const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;\n  return mobileRegex.test(navigator.userAgent);\n};\n\nconst coordinateToLatLng = coord => {\n  return new google.maps.LatLng(coord[0], coord[1]);\n};\n\nconst dateToString = date => {\n  function pad(n) {\n    return (n < 10) ? '0' + n : n;\n  }\n\n  return pad(date.getFullYear()) + '-' +\n         pad(date.getMonth()) + '-' +\n         pad(date.getDate());\n};\n\nmodule.exports = {\n  urlParameter: urlParameter,\n  isMobile: isMobile,\n  coordinateToLatLng: coordinateToLatLng,\n  dateToString: dateToString\n};\n","'use strict';\n\nconst Utils = require('./utils');\n\nconst Settings = {};\n\nSettings.get = settingName => {\n  const setting = Settings.settings[settingName];\n  let rawSettingValue = localStorage.getItem(settingName);\n\n  if (setting.getURLValue === undefined) {\n    setting.getURLValue = function () {\n      return Utils.urlParameter(settingName);\n    };\n  }\n\n  if (setting.getURLValue && setting.getURLValue != false) {\n    const urlValue = setting.getURLValue();\n    if (urlValue) {\n      rawSettingValue = urlValue;\n    }\n  }\n\n  if (rawSettingValue === undefined || rawSettingValue === null) {\n    return setting.defaultValue;\n  }\n\n  if (setting.type == 'boolean') {\n    return rawSettingValue == 'true';\n  } else if (setting.type == 'float') {\n    return parseFloat(rawSettingValue);\n  } else if (setting.type == 'json') {\n    return JSON.parse(rawSettingValue);\n  }\n\n  return rawSettingValue;\n};\n\nSettings.set = (settingName, value) => {\n  const setting = Settings.settings[settingName];\n\n  setting.getURLValue = false;\n\n  if (setting.type == 'json') {\n    localStorage.setItem(settingName, JSON.stringify(value));\n  } else {\n    localStorage.setItem(settingName, value);\n  }\n};\n\nSettings.settings = {\n  showGyms: {\n    type: 'boolean',\n    defaultValue: true\n  },\n  showPokestops: {\n    type: 'boolean',\n    defaultValue: false\n  },\n  showPortals: {\n    type: 'boolean',\n    defaultValue: false\n  },\n  showParks: {\n    type: 'boolean',\n    defaultValue: false\n  },\n  highlightNewFeatures: {\n    type: 'boolean',\n    defaultValue: false\n  },\n  s2Cells: {\n    type: 'json',\n    defaultValue: []\n  },\n  s2CellColors: {\n    type: 'json',\n    defaultValue: {\n      '1': '#FF6F00',\n      '2': '#F57F17',\n      '3': '#827717',\n      '4': '#33691E',\n      '5': '#1B5E20',\n      '6': '#004D40',\n      '7': '#006064',\n      '8': '#01579B',\n      '9': '#0D47A1',\n      '10': '#1A237E',\n      '11': '#6A1B9A',\n      '12': '#AD1457',\n      '13': '#b71c1c',\n      '14': '#BF360C',\n      '15': '#FF7043',\n      '16': '#FFCA28',\n      '17': '#FDD835',\n      '18': '#00796B',\n      '19': '#0288D1',\n      '20': '#64B5F6'\n    }\n  },\n  mapCenter: {\n    type: 'json',\n    defaultValue: {\n      lat: 52.63282,\n      lng: 1.29732\n    }\n  },\n  zoomLevel: {\n    type: 'float',\n    defaultValue: 13\n  }\n};\n\nmodule.exports = Settings;\n","'use strict';\n\nconst Settings = require('./settings');\nconst Utils = require('./utils');\n\nwindow.initMap = () => {\n  const map = new google.maps.Map(document.getElementById('map'), {\n    center: Settings.get('mapCenter'),\n    zoom: Settings.get('zoomLevel'),\n    gestureHandling: 'greedy',\n    fullscreenControl: false,\n    streetViewControl: true,\n    mapTypeControl: true,\n    clickableIcons: false,\n    mapTypeControlOptions: {\n      style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,\n      position: google.maps.ControlPosition.LEFT_BOTTOM,\n      mapTypeIds: [\n        google.maps.MapTypeId.ROADMAP,\n        google.maps.MapTypeId.SATELLITE,\n        google.maps.MapTypeId.HYBRID\n      ]\n    }\n  });\n\n  initSearchBox(map);\n  initS2Cells(map);\n  initFeatures(map);\n  initParks(map);\n  initSettings(map);\n};\n\nfunction initSearchBox(map) {\n  const searchBoxInput = document.createElement('input');\n  searchBoxInput.setAttribute('id', 'pac-input');\n  searchBoxInput.setAttribute('class', 'controls');\n  searchBoxInput.setAttribute('type', 'text');\n  searchBoxInput.setAttribute('placeholder', 'Search Gyms and Pokestops');\n\n  const searchBoxDropdown = document.createElement('div');\n  searchBoxDropdown.setAttribute('class', 'pac-container  pac-logo');\n\n  map.controls[google.maps.ControlPosition.TOP_LEFT].push(searchBoxInput);\n  map.searchBox = $(searchBoxInput);\n  map.searchBox.prop('disabled', true);\n\n  map.searchBox.dropdown = $(searchBoxDropdown);\n  map.searchBox.dropdown.appendTo('body');\n\n  $(document).click(function () {\n    map.searchBox.dropdown.hide();\n  });\n\n  map.searchBox.click(function (e) {\n    e.stopPropagation();\n  });\n\n  map.searchBox.dropdown.add = function (feature) {\n    const resultWrapper = document.createElement('div');\n    resultWrapper.setAttribute('class', 'pac-item');\n\n    const resultIcon = document.createElement('span');\n    resultIcon.setAttribute('class', `pac-icon pac-icon-${feature.type}`);\n\n    const resultMatch = document.createElement('span');\n    resultMatch.setAttribute('class', 'pac-item-query');\n    resultMatch.innerHTML =\n      `<span class=\"pac-item-query\">${feature.name}</span>`;\n\n    const resultDescription = document.createElement('span');\n    resultDescription.innerHTML = feature.description || '';\n\n    resultWrapper.appendChild(resultIcon);\n    resultWrapper.appendChild(resultMatch);\n    resultWrapper.appendChild(resultDescription);\n    map.searchBox.dropdown[0].appendChild(resultWrapper);\n\n    $(resultWrapper).click(function () {\n      map.panTo(feature.location);\n      feature.label.open(map);\n    });\n  };\n\n  map.searchBox.on('input', function (e) {\n    map.searchBox.dropdown.empty();\n\n    if (!map.features || !map.features.nameLookup) return;\n\n    const matches = map.features.nameLookup.search(e.currentTarget.value);\n    const visibleMatches = matches.filter(function (match) {\n      return match.isShown();\n    });\n\n    $.each(visibleMatches.slice(0, 4), function (index, match) {\n      map.searchBox.dropdown.add(match);\n    });\n\n    map.searchBox.dropdown.show();\n  });\n}\n\nfunction initS2Cells(map) {\n  map.drawS2Cells = function (newS2Cells) {\n    const oldS2Cells = (map.s2Cells || []).slice(0, -200);\n    $.each(oldS2Cells, function (index, s2Cell) {\n      s2Cell.hide();\n    });\n\n    const s2Cells = (map.s2Cells || []).slice(-200);\n    $.merge(s2Cells, newS2Cells);\n\n    $.each(s2Cells, function (index, s2Cell) {\n      if (s2Cell.shouldShow()) {\n        if (!s2Cell.isShown()) {\n          s2Cell.draw(map);\n          s2Cell.show(map);\n        }\n      } else {\n        s2Cell.hide();\n      }\n    });\n\n    map.s2Cells = s2Cells;\n  };\n\n  map.updateS2Cells = function () {\n    map.cancelS2CellUpdate();\n\n    map.pendingS2CellUpdate = setTimeout(function () {\n      const newS2Cells = loadS2Cells(map);\n      map.drawS2Cells(newS2Cells);\n    }, 800);\n  };\n\n  map.cancelS2CellUpdate = function () {\n    if (map.pendingS2CellUpdate) {\n      clearTimeout(map.pendingS2CellUpdate);\n    }\n  };\n\n  map.shouldDisplayCellLevel = function (level) {\n    let cellLevelLimit;\n    if ((level == 1) || (level == 2)) {\n      cellLevelLimit = 0;\n    } else {\n      cellLevelLimit = level;\n    }\n\n    if (Utils.isMobile() && (cellLevelLimit > 0)) cellLevelLimit -= 1;\n    return map.getZoom() >= cellLevelLimit;\n  };\n\n  google.maps.event.addListener(map, 'idle', map.updateS2Cells);\n  google.maps.event.addListener(map, 'bounds_changed', map.cancelS2CellUpdate);\n}\n\nfunction initFeatures(map) {\n  map.showFeatures = function (shouldRedraw) {\n    $.each(map.features, function (index, feature) {\n      feature.show(map, shouldRedraw);\n    });\n  };\n\n  return loadAndDrawFeatureDataIncrementally(map)\n    .then(function (features) {\n      map.features = features;\n\n      map.features.nameLookup = new Fuse(map.features, {\n        shouldSort: true,\n        threshold: 0.5,\n        location: 0,\n        distance: 100,\n        maxPatternLength: 32,\n        minMatchCharLength: 1,\n        keys: [\n          'name'\n        ]\n      });\n\n      $('#pac-input').prop('disabled', false);\n    });\n}\n\nfunction initParks(map) {\n  loadParkData()\n    .then(function (parks) {\n      const parksLayer = new google.maps.Data();\n      parksLayer.addGeoJson(parks);\n      parksLayer.setStyle({\n        fillColor: 'green'\n      });\n\n      parksLayer.show = function (show) {\n        if (show === false) {\n          parksLayer.setMap(null);\n        } else {\n          parksLayer.setMap(map);\n        }\n      };\n\n      map.parksLayer = parksLayer;\n      map.parksLayer.show(Settings.get('showParks'));\n    });\n}\n\n/* eslint-disable quotes */\nfunction initSettings(map) {\n  google.maps.event.addListener(map, 'click', function () {\n    $('.settings').collapse('hide');\n  });\n\n  $('[name=\"toggle-gyms\"]').bootstrapSwitch();\n  $('[name=\"toggle-gyms\"]').bootstrapSwitch('state',\n    Settings.get('showGyms'));\n  $('[name=\"toggle-gyms\"]').on('switchChange.bootstrapSwitch',\n    function(event, state) {\n      Settings.set('showGyms', state);\n      map.showFeatures();\n    }\n  );\n\n  $(\"[name='toggle-pokestops']\").bootstrapSwitch();\n  $(\"[name='toggle-pokestops']\").bootstrapSwitch('state',\n    Settings.get('showPokestops'));\n  $('[name=\"toggle-pokestops\"]').on('switchChange.bootstrapSwitch',\n    function(event, state) {\n      Settings.set('showPokestops', state);\n      map.showFeatures();\n    }\n  );\n\n  $(\"[name='toggle-portals']\").bootstrapSwitch();\n  $(\"[name='toggle-portals']\").bootstrapSwitch('state',\n    Settings.get('showPortals'));\n  $('[name=\"toggle-portals\"]').on('switchChange.bootstrapSwitch',\n    function(event, state) {\n      Settings.set('showPortals', state);\n      map.showFeatures();\n    }\n  );\n\n  $(\"[name='toggle-parks']\").bootstrapSwitch();\n  $(\"[name='toggle-parks']\").bootstrapSwitch('state',\n    Settings.get('showParks'));\n  $('[name=\"toggle-parks\"]').on('switchChange.bootstrapSwitch',\n    function(event, state) {\n      Settings.set('showParks', state);\n      map.parksLayer.show(state);\n    }\n  );\n\n  $(\"[name='toggle-highlight-new-features']\").bootstrapSwitch();\n  $(\"[name='toggle-highlight-new-features']\").bootstrapSwitch('state',\n    Settings.get('highlightNewFeatures'));\n  $('[name=\"toggle-highlight-new-features\"]').on('switchChange.bootstrapSwitch',\n    function(event, state) {\n      Settings.set('highlightNewFeatures', state);\n      map.showFeatures(function (feature) {\n        return feature.isNew;\n      });\n    }\n  );\n\n  google.maps.event.addListener(map, 'idle', function () {\n    Settings.set('mapCenter', {\n      lat: map.getCenter().lat(),\n      lng: map.getCenter().lng()\n    });\n    Settings.set('zoomLevel', map.getZoom());\n  });\n\n  function setS2CellLevelOptions() {\n    let s2CellLevelOptions = '';\n    for (let level = 1; level <= 20; ++level) {\n      let optionTag = '';\n      if (map.shouldDisplayCellLevel(level)) {\n        optionTag += '<option value=\"' + level + '\">';\n        optionTag += level;\n      } else {\n        optionTag += '<option value=\"' + level + '\"'+ 'disabled' + '>';\n        optionTag += level + ' - zoom in';\n      }\n      optionTag += '</option>';\n\n      s2CellLevelOptions += optionTag;\n    }\n\n    $(\"[name='select-s2-cells']\").html(s2CellLevelOptions);\n    $(\"[name='select-s2-cells']\").selectpicker('val', Settings.get('s2Cells'));\n    $(\"[name='select-s2-cells']\").selectpicker('refresh');\n  }\n\n  setS2CellLevelOptions();\n\n  google.maps.event.addListener(map, 'idle', setS2CellLevelOptions);\n\n  $(\"[name='select-s2-cells']\").selectpicker({\n    size: 5,\n    dropupAuto: false\n  });\n  $(\"[name='select-s2-cells']\").on('changed.bs.select', function () {\n    Settings.set('s2Cells', $(this).val() || []);\n    map.updateS2Cells();\n  });\n\n  $('.select-s2-cells-wrapper .bs-select-all').prop('disabled', true);\n}\n/* eslint-enable quotes */\n\nfunction loadAndDrawFeatureDataIncrementally(map) {\n  const chunkSize = 250;\n\n  return fetchFeatureCount()\n    .then(function (featureCount) {\n      const chunks = Math.ceil(featureCount / chunkSize);\n\n      const featureDataPromises = [];\n      for (let i = 0; i < chunks; ++i) {\n        const promise = fetchFeatureData(chunkSize, i * chunkSize)\n          .then(function (featureData) {\n            return loadFeatures(featureData);\n          })\n          .then(function (featureData) {\n            $.each(featureData, function (index, feature) {\n              feature.show(map);\n            });\n            return featureData;\n          });\n        featureDataPromises.push(promise);\n      }\n\n      return Promise.all(featureDataPromises);\n    })\n    .then(function (featureDataChunks) {\n      return featureDataChunks.reduce(function (featureData, chunk) {\n        return featureData.concat(chunk);\n      }, []);\n    });\n}\n\nfunction fetchFeatureCount() {\n  const request = $.ajax({\n    type: 'GET',\n    url: 'https://api.pokemongonorwich.uk/pois?action=count',\n    dataType: 'json'\n  });\n  return Promise.resolve(request);\n}\n\nfunction fetchFeatureData(chunkSize, start) {\n  const request = $.ajax({\n    type: 'GET',\n    url: 'https://api.pokemongonorwich.uk/pois?action=get' +\n         `&count=${chunkSize}` +\n         `&start=${start}`,\n    dataType: 'json'\n  });\n  return Promise.resolve(request);\n}\n\nfunction loadFeatures(featureData) {\n  const baseURL = location.protocol + '//' + location.host + location.pathname;\n\n  let dateOfLastUpdate = new Date(1990, 0, 1);\n  $.each(featureData, function (index, feature) {\n    if (!feature.dateAdded) return;\n\n    feature.dateAdded = new Date(feature.dateAdded);\n    if (feature.dateAdded > dateOfLastUpdate) {\n      dateOfLastUpdate = feature.dateAdded;\n    }\n  });\n\n  const validFeatures = [];\n\n  $.each(featureData, function (index, feature) {\n    if (!feature.type ||\n        !feature.latitude ||\n        !feature.longitude) {\n      return;\n    }\n\n    feature.type = feature.type.toLowerCase();\n    feature.coords = [feature.latitude, feature.longitude];\n    feature.location = Utils.coordinateToLatLng(feature.coords);\n    feature.permalinkName = feature.id;\n    feature.permalink = `${baseURL}?${feature.type}=${feature.id}`;\n\n    if (feature.dateAdded &&\n        (feature.dateAdded.getTime() >= dateOfLastUpdate.getTime())) {\n      feature.isNew = true;\n    }\n\n    feature.hide = function () {\n      if (feature.marker) {\n        feature.marker.setMap(null);\n      }\n    };\n\n    feature.show = function (map, shouldRedraw) {\n      if (this.shouldShow()) {\n        if (shouldRedraw && shouldRedraw(feature)) {\n          this.draw(map, true);\n        }\n\n        if (!this.isShown()) {\n          this.draw(map);\n          this.marker.setMap(map);\n        }\n      } else {\n        this.hide();\n      }\n    };\n\n    feature.shouldShow = function () {\n      if (((feature.type == 'gym') && Settings.get('showGyms')) ||\n          ((feature.type == 'pokestop') && Settings.get('showPokestops')) ||\n          ((feature.type == 'portal') && Settings.get('showPortals'))) {\n        return true;\n      }\n    };\n\n    feature.isShown = function () {\n      return feature.marker && feature.marker.map;\n    };\n\n    feature.draw = function (map, redraw) {\n      if (redraw) {\n        this.hide();\n        drawFeature(map, feature);\n      } else if (!feature.marker) {\n        drawFeature(map, feature);\n      }\n    };\n\n    validFeatures.push(feature);\n  });\n\n  return validFeatures;\n}\n\nfunction loadParkData() {\n  return Promise.resolve($.getJSON('/data/parks.geojson'));\n}\n\nfunction drawFeature(map, feature) {\n  const featureMarkerIcons = {\n    gym: '/assets/images/gym.png',\n    new_gym: '/assets/images/gym.png',\n    pokestop: '/assets/images/pokestop.png',\n    new_pokestop: '/assets/images/new_pokestop.png',\n    portal: '/assets/images/portal.png',\n    new_portal: '/assets/images/new_portal.png'\n  };\n\n  let markerIcon;\n  if (Settings.get('highlightNewFeatures') && feature.isNew) {\n    markerIcon = featureMarkerIcons['new_' + feature.type];\n  } else {\n    markerIcon = featureMarkerIcons[feature.type];\n  }\n\n  const anchorX = (feature.type == 'gym') ? 22 : 15;\n\n  let featureMarker;\n  if (featureMarkerIcons[feature.type]) {\n    featureMarker = new google.maps.Marker({\n      position: feature.location,\n      icon: {\n        url: markerIcon,\n        scaledSize: new google.maps.Size(30, 30),\n        anchor: new google.maps.Point(anchorX, 30)\n      },\n      zIndex: 20\n    });\n  } else {\n    featureMarker = new google.maps.Marker({\n      position: feature.location,\n      zIndex: 20\n    });\n  }\n\n  feature.marker = featureMarker;\n\n  let featureLabel;\n  if (feature.type == 'gym') {\n    featureLabel = gymLabel(feature);\n  } else if (feature.type == 'pokestop') {\n    featureLabel = pokestopLabel(feature);\n  } else if (feature.type == 'portal') {\n    featureLabel = portalLabel(feature);\n  }\n\n  if (featureLabel) {\n    feature.label = featureLabel;\n    addLabelActions(map, feature);\n  }\n}\n\nfunction gymLabel(gym) {\n  const name = gym.name || 'Gym';\n  const description = '' + (gym.description || '');\n\n  let content = `\n    <div class=\"feature-label\">\n      <div class=\"feature-label-name\">\n        <b>${name}</b>\n      </div>\n      <div class=\"feature-label-description\">\n        ${description.replace(/\\\\n/gi, '<br />')}\n      </div>\n    </div>`;\n\n  return new google.maps.InfoWindow({\n    content: content,\n    pixelOffset: new google.maps.Size(-7, -30)\n  });\n}\n\nfunction pokestopLabel(pokestop) {\n  const name = pokestop.name || 'Pokestop';\n  const description = pokestop.description || '';\n\n  let content = `\n    <div class=\"feature-label\">\n      <div class=\"feature-label-name\">\n        <b>${name}</b>\n      </div>\n      <div class=\"feature-label-description\">\n        ${description.replace(/\\\\n/gi, '<br />')}\n      </div>\n    </div>`;\n\n  return new google.maps.InfoWindow({\n    content: content,\n    pixelOffset: new google.maps.Size(0, -30)\n  });\n}\n\nfunction portalLabel(portal) {\n  const name = portal.name || 'Portal';\n  const description = portal.description || '';\n\n  let content = `\n    <div class=\"feature-label\">\n      <div class=\"feature-label-name\">\n        <b>${name}</b>\n      </div>\n      <div class=\"feature-label-description\">\n        ${description.replace(/\\\\n/gi, '<br />')}\n      </div>\n    </div>`;\n\n  return new google.maps.InfoWindow({\n    content: content,\n    pixelOffset: new google.maps.Size(0, -30)\n  });\n}\n\nfunction addLabelActions(map, feature) {\n  feature.label.isOpen = false;\n\n  feature.label._open = feature.label.open;\n  feature.label._close = feature.label.close;\n\n  feature.label.open = function (map) {\n    feature.label.setPosition(feature.location);\n    feature.label._open(map);\n    feature.label.isOpen = true;\n  };\n\n  feature.label.close = function () {\n    feature.label._close();\n    feature.label.isOpen = false;\n  };\n\n  feature.marker.addListener('click', function () {\n    if (feature.label.isOpen) {\n      feature.label.close();\n    } else {\n      feature.label.open(map);\n    }\n  });\n\n  map.addListener('click', function () {\n    feature.label.close();\n  });\n\n  feature.label.addListener('closeclick', function () {\n    feature.label.close();\n  });\n}\n\nfunction loadS2Cells(map) {\n  if (!map.getBounds()) return [];\n\n  const mapBounds = map.getBounds();\n  const swBound = mapBounds.getSouthWest();\n  const neBound = mapBounds.getNorthEast();\n\n  const southWest = S2.S2LatLng.fromDegrees(swBound.lat(), swBound.lng());\n  const northEast = S2.S2LatLng.fromDegrees(neBound.lat(), neBound.lng());\n  const screenRegion = S2.S2LatLngRect.fromLatLng(southWest, northEast);\n\n  const s2Cells = [];\n  $.each(Settings.get('s2Cells'), function (index, level) {\n    if (!map.shouldDisplayCellLevel(level)) return;\n\n    const regionCoverer = new S2.S2RegionCoverer();\n    regionCoverer.setMinLevel(level);\n    regionCoverer.setMaxLevel(level);\n    regionCoverer.setMaxCells(50);\n\n    const s2CellIds = regionCoverer.getCoveringCells(screenRegion);\n    $.each(s2CellIds, function (index, s2CellId) {\n      const s2Cell = new S2.S2Cell(s2CellId);\n\n      s2Cell.hide = function () {\n        if (s2Cell.polygon) {\n          s2Cell.polygon.setMap(null);\n        }\n      };\n\n      s2Cell.show = function (map) {\n        if (s2Cell.polygon) {\n          s2Cell.polygon.setMap(map);\n        }\n      };\n\n      s2Cell.shouldShow = function () {\n        return (($.inArray('' + s2Cell.level, Settings.get('s2Cells')) > -1) &&\n                (map.shouldDisplayCellLevel(s2Cell.level)));\n      };\n\n      s2Cell.isShown = function () {\n        return s2Cell.polygon && s2Cell.polygon.map;\n      };\n\n      s2Cell.draw = function (map) {\n        if (!s2Cell.polygon) {\n          drawS2Cell(map, s2Cell);\n        }\n      };\n\n      s2Cells.push(s2Cell);\n    });\n  });\n\n  return s2Cells;\n}\n\nfunction drawS2Cell(map, s2Cell) {\n  function s2PointToGMapsLatLng(s2Point) {\n    const s2LatLng = S2.S2LatLng.fromPoint(s2Point);\n    return {\n      lat: s2LatLng.latDegrees.toNumber(),\n      lng: s2LatLng.lngDegrees.toNumber()\n    };\n  }\n\n  const verticies = [\n    s2PointToGMapsLatLng(s2Cell.getVertex(0)),\n    s2PointToGMapsLatLng(s2Cell.getVertex(1)),\n    s2PointToGMapsLatLng(s2Cell.getVertex(2)),\n    s2PointToGMapsLatLng(s2Cell.getVertex(3))\n  ];\n\n  const color = Settings.get('s2CellColors')[s2Cell.level];\n\n  s2Cell.polygon = new google.maps.Polygon({\n    paths: verticies,\n    strokeColor: color,\n    strokeOpacity: 0.75,\n    strokeWeight: 2 + ((20 - s2Cell.level) / 4),\n    fillColor: color,\n    fillOpacity: 0,\n    zIndex: 120 - s2Cell.level\n  });\n}\n"],"sourceRoot":""}