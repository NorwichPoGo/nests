!function(){function u(a,i,s){function l(t,n){if(!i[t]){if(!a[t]){var e="function"==typeof require&&require;if(!n&&e)return e(t,!0);if(c)return c(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var r=i[t]={exports:{}};a[t][0].call(r.exports,function(n){var e;return l(a[t][1][n]||n)},r,r.exports,u,a,i,s)}return i[t].exports}for(var c="function"==typeof require&&require,n=0;n<s.length;n++)l(s[n]);return l}return u}()({1:[function(n,e,t){"use strict";var s=[new Date(2018,4,19),new Date(2018,4,5),new Date(2018,3,22),new Date(2018,3,8),new Date(2018,2,22),new Date(2018,2,8),new Date(2018,1,25)],o=[new Date(2018,3,30),new Date(2011,0,1)],r="https://raw.githubusercontent.com/pogo-excalibur/images/master/pogo";function a(r){l().then(function(n){var t=urlParameter("nest");if(t){var o=void 0;$.each(n,function(n,e){if(e.permalinkName==t)return o=e,!1}),o&&p(r,o)}return n}).then(function(n){return Promise.all([n,c(n),u()])}).then(function(n){var e=n[0],t=n[1],a=n[2];return $.each(t,function(n,o){var r=s[n];$.each(e,function(n,e){if(o[n]){if(void 0===o[n].id){var t=a[o[n]];o[n]={id:o[n],name:t.name}}e.migrations||(e.migrations=[]),e.migrations[r]=o[n]}})}),e}).then(function(n){$.each(n,function(n,e){g(r,e)})})}function i(n){google.maps.event.addListener(n,"idle",function(){Settings.set("mapCenter",{lat:n.getCenter().lat(),lng:n.getCenter().lng()}),Settings.set("zoomLevel",n.getZoom())})}function l(){return Promise.resolve($.getJSON("/data/nests.json")).then(function(e){return Promise.resolve($.getJSON("/data/manual_nests.json")).then(function(n){return Object.assign(e,n)})}).then(function(n){return $.each(n,function(n,e){e.center=b(e.center),e.region=$.map(e.region,function(n){return b(n)}),e.permalinkName=e.name.replace(/[^\w]/g,"").toLowerCase()}),n})}function c(n){return Promise.all($.map(s,function(n){var e="/data/nest_migrations/"+h(n)+".json";return Promise.resolve($.getJSON(e))}))}function u(){return Promise.resolve($.getJSON("/data/pokemon.json"))}function p(n,e){n.panTo(e.center),n.setZoom(17)}function g(n,e){function t(){e.label.isOpen?(e.label.close(),e.label.isOpen=!1):(e.label.setPosition(e.center),e.label.open(n),e.label.isOpen=!0)}e.polygon=m(e),e.polygon.setMap(n),e.marker=f(e),e.marker.setMap(n),e.label=v(e),e.label.isOpen=!1,e.polygon.addListener("click",function(){t()}),e.marker.addListener("click",function(){t()}),n.addListener("click",function(){e.label.close(),e.label.isOpen=!1}),e.label.addListener("closeclick",function(){e.label.isOpen=!1})}function m(n){var e="green";return n.date_added==h(o[0])&&(e="blue"),new google.maps.Polygon({paths:n.region,fillColor:e,fillOpacity:.5,strokeColor:e,strokeOpacity:1,strokeWeight:0})}function f(n){var e;return d(n)?new google.maps.Marker({position:n.center,icon:d(n)}):new google.maps.Marker}function d(n){var e=w(n,s[0]);if(e)return{url:r+"/"+e.id+".png",scaledSize:new google.maps.Size(34,34),anchor:new google.maps.Point(17,17)}}function v(r){function a(n){return n?n.name+" (#"+n.id+")":"?"}var n=$.map(s,function(n,e){var t,o;return'\n      <div class="nest-label-pokemon">\n        '+(0==e?"Current":h(n))+": "+a(w(r,n))+"\n      </div>"}).join("\n"),e,t=location.protocol+"//"+location.host+location.pathname+"?nest="+r.permalinkName,o=void 0;o=r.spawnpoints?1<r.spawnpoints?r.spawnpoints+" spawnpoints":r.spawnpoints+" spawnpoint":"Number of spawnpoints unknown";var i='\n    <div class="nest-label">\n      <div class="nest-label-name">\n        <b>'+r.name+'</b>\n        <a href="'+t+'"><span class="fas fa-link"></span></a>\n      </div>\n      <div class="nest-label-spawnpoints">\n        ('+o+")\n      </div>\n      <br/>\n      "+n+"\n    </div>";return new google.maps.InfoWindow({content:i})}function w(n,e){if(n.migrations&&n.migrations[e]&&0<n.migrations[e].id)return n.migrations[e]}function b(n){return new google.maps.LatLng(n[0],n[1])}function h(n){function e(n){return n<10?"0"+n:n}return e(n.getFullYear())+"-"+e(n.getMonth())+"-"+e(n.getDate())}window.initMap=function(){var n=new google.maps.Map(document.getElementById("map"),{center:Settings.get("mapCenter"),zoom:Settings.get("zoomLevel"),gestureHandling:"greedy",fullscreenControl:!1,streetViewControl:!0,mapTypeControl:!0,clickableIcons:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,position:google.maps.ControlPosition.RIGHT_TOP,mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID]}});a(n),i(n)}},{}]},{},[1]);
//# sourceMappingURL=nests.min.js.map